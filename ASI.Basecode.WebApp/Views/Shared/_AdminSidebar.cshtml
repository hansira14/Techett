<div class="sidebar">
    <div class="logo">
        <img id="logo-img" src="~/img/logo-light.png" alt="Logo" />
    </div>

    <ul class="sidebar-menu">
        <li class="@(ViewContext.RouteData.Values["Action"].ToString() == "Index" ? "active" : "")">
            <a asp-controller="Home" asp-action="Index" id="dashboardLink">
                <i class="fa-solid fa-house sidebar-icon"></i>
                <span>Dashboard</span>
                <i id="dashboardArrow" class="fa-solid fa-chevron-right dropdown-arrow"></i>
            </a>
            <!-- Sub-menu for Dashboard -->
            <ul class="sidebar-submenu" id="dashboardDropdown">
                <li class="@(ViewContext.RouteData.Values["Action"].ToString() == "Tickets" ? "active" : "")">
                    <a asp-controller="Ticket" asp-action="Tickets">
                        <i class="fa-solid fa-ticket-alt sidebar-icon"></i>
                        <span>Tickets</span>
                    </a>
                </li>
                <li class="@(ViewContext.RouteData.Values["Action"].ToString() == "Index" ? "active" : "")">
                    <a asp-controller="Article" asp-action="Index">
                        <i class="fa-solid fa-book sidebar-icon"></i>
                        <span>Articles</span>
                    </a>
                </li>
            </ul>
        </li>
        <li class="@(ViewContext.RouteData.Values["Action"].ToString() == "Users" ? "active" : "")">
            <a asp-controller="Account" asp-action="Users">
                <i class="fa-solid fa-user sidebar-icon"></i> <!-- Added class here -->
                <span>Users</span>
            </a>
        </li>

        <li class="@(ViewContext.RouteData.Values["Action"].ToString() == "Settings" ? "active" : "")">
            <a href="#">
                <i class="fa-solid fa-gear sidebar-icon"></i> <!-- Added class here -->
                <span>Settings</span>
            </a>
        </li>
        <li class="@(ViewContext.RouteData.Values["Action"].ToString() == "About" ? "active" : "")">
            <a href="#">
                <i class="fa-solid fa-list sidebar-icon"></i> <!-- Added class here -->
                <span>About Us</span>
            </a>
        </li>
    </ul>

    <div class="signout">
        <a id="logoutButton" asp-action="SignOutAdmin" asp-controller="Account">
            <i class="fas fa-sign-out-alt sidebar-icon"></i> <!-- Added class here -->
            <span>Logout @HttpContextAccessor.HttpContext.Session.GetString("UserName")</span>
        </a>
    </div>

</div>
<script>
    document.getElementById("logoutButton").addEventListener("click", function (event) {
        event.preventDefault(); // Prevent the default action
        // Hide the sidebar
        document.querySelector(".sidebar").style.display = "none";

        // Redirect to the login page after a brief delay (optional)
        setTimeout(function () {
            window.location.href = "/Account/Login"; // Adjust the URL as needed
        }, 200); // Delay in milliseconds
    });

    document.addEventListener("DOMContentLoaded", function () {
        var dashboardLink = document.getElementById("dashboardLink");
        var dashboardDropdown = document.getElementById("dashboardDropdown");
        var dashboardArrow = document.getElementById("dashboardArrow");

        // Toggle function for the Dashboard dropdown
        function toggleDropdown() {
            if (dashboardDropdown.style.display === "none" || dashboardDropdown.style.display === "") {
                dashboardDropdown.style.display = "block";
                dashboardArrow.classList.add("rotate-arrow");
                localStorage.setItem("dashboardExpanded", "true"); // Store state in localStorage
            } else {
                dashboardDropdown.style.display = "none";
                dashboardArrow.classList.remove("rotate-arrow");
                localStorage.setItem("dashboardExpanded", "false");
            }
        }

        // Check local storage for dropdown state on page load
        var isExpanded = localStorage.getItem("dashboardExpanded");
        if (isExpanded === "true") {
            dashboardDropdown.style.display = "block";
            dashboardArrow.classList.add("rotate-arrow");
        }

        // Add click event to the dashboard link to toggle the dropdown
        dashboardLink.addEventListener("click", function (event) {
            event.preventDefault(); // Prevent navigation to handle toggle first
            toggleDropdown();
            // Navigate to Admin/Index after toggling
            setTimeout(function () {
                window.location.href = dashboardLink.href;
            }, 100); // Adjust delay as needed
        });
    });

</script>